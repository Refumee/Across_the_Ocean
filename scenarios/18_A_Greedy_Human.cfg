#textdomain wesnoth-Across_the_Ocean
[scenario]
    id=18_A_Greedy_Human
    name= _ "A Greedy Human"
    next_scenario=19_Across_the_Ocean
    map_data="{~add-ons/Across_the_Ocean/maps/18_A_Greedy_Human.map}"

    [story]
        [part]
            story= _ "Acting on the scout's information, Skaphee and the lizards sailed to Bilheld without their Carapaced allies this time. It was the longest journey for the Saurians, but the Saurian Steersmen controlled the ships well."
            {ATO_BG_MAP}
            {ATO_BACK_TO_THE_SWAMP}
        [/part]
        [part]
            show_title=yes
            {ATO_BG_MAP}
            {ATO_BACK_TO_THE_SWAMP}
            {NEW_JOURNEY 840 604}
            {NEW_JOURNEY 826 598}
            {NEW_JOURNEY 812 604}
            {NEW_JOURNEY 800 613}
            {NEW_JOURNEY 789 622}
            {NEW_JOURNEY 773 626}
            {NEW_JOURNEY 757 628}
            {NEW_JOURNEY 741 630}
            {NEW_JOURNEY 725 629}
            {NEW_JOURNEY 709 627}

            {NEW_JOURNEY 694 621}
            {NEW_JOURNEY 682 613}
            {NEW_JOURNEY 670 603}

            {NEW_JOURNEY 659 592}
            {NEW_JOURNEY 648 581}
            {NEW_JOURNEY 637 570}
            {NEW_JOURNEY 626 559}
            {NEW_JOURNEY 615 548}
            {NEW_JOURNEY 604 537}
            {NEW_JOURNEY 593 526}
            {NEW_JOURNEY 582 515}
            {NEW_JOURNEY 571 504}
            {NEW_JOURNEY 560 493}
            {NEW_JOURNEY 549 482}
            {NEW_JOURNEY 538 471}
            {NEW_JOURNEY 527 460}
            {NEW_JOURNEY 516 449}
            {NEW_JOURNEY 505 438}
            {NEW_JOURNEY 494 427}
            {NEW_JOURNEY 483 416}
            {NEW_JOURNEY 472 405}
            {NEW_JOURNEY 460 394}

            {NEW_JOURNEY 447 386}
            {NEW_JOURNEY 434 378}
            {NEW_JOURNEY 420 372}

            {NEW_JOURNEY 406 367}
            {NEW_JOURNEY 392 362}
            {NEW_JOURNEY 376 359}
            {NEW_JOURNEY 360 356}
            {NEW_JOURNEY 344 353}
            {NEW_JOURNEY 328 351}
            {NEW_JOURNEY 312 349}
            {NEW_JOURNEY 296 347}
            {NEW_JOURNEY 280 346}
            {NEW_BATTLE 264 345}
        [/part]
    [/story]

    [time_area]
        side=1
        x=19,20,21,22,23,24-30,31-32,33-34,35
        y=16-24,15-24,15-25,14-25,14-26,13-26,14-26,15-26,16-26
        {UNDERGROUND}
    [/time_area]
    [time_area]
        side=1
        x=0-10,11-12,13-14,15-16,17-18,19-20,21-22
        y=26-41,27-41,28-41,29-41,30-41,31-41,32-40
        {UNDERGROUND}
    [/time_area]

    {MORNING}
    {AFTERNOON}
    {DUSK}
    {FIRST_WATCH}
    {SECOND_WATCH}
    {DAWN}

    {SCENARIO_MUSIC "nunc_dimittis.ogg"}
    {EXTRA_SCENARIO_MUSIC "the_dangerous_symphony.ogg"}
    {EXTRA_SCENARIO_MUSIC "into_the_shadows.ogg"}
    {EXTRA_SCENARIO_MUSIC "knalgan_theme.ogg"}

    {TURNS 48 44 40}
    victory_when_enemies_defeated=no

    [side]
        {ATO_SIDE_1}
        recruit=Saurian Fighter,Saurian Skirmisher,Saurian Augur,Saurian Blacksmith
        {GOLD 240 220 210}
        {INCOME 10 9 8}
        fog=yes
        shroud=yes
        shroud_data="|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111110000000000000000
|111111111111111111111111111000000000000000
|111111111111111111111111111000000000000000
|111111111111111111111111111100000000000000
|111111111111111111111111111100000000000000
|111111111111111111111111111110000000000000
|111111111111111111111111111110000000000000
|111111111111111111111111111111000000000000
|111111111111111111111111111111000000000000
|111111111111111100000000011111100000000000
|111111111111111000000000011111100000000000
|111111111111111000000000001111110000000000
|111111111111110000000000001111110000000001
|111111111111110000000000000111111111111111
|111111111111100000000000000111111111111111
|111111111111100000000000000111111111111111
|111111111111100000000000000111111111111111
|111111111111100000000000000111111111111111
|111111111111100000000000000111111111111111
|111111111111100000000000000111111111111111
|111111111111100000000000000111111111111111
|111111111111110000000000000111111111111111
|111111111111110000000000000111111111111111
|111111111111111000000000000111111111111111
|111111111111111000000000000111111111111111
|111111111111111100000000000111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111
|111111111111111111111111111111111111111111"
    [/side]
    [side]
        side=2
        controller=ai
        team_name=human
        user_team_name=_"Nagas"
        type=Naga Myrmidon
        id=Inelii
        name= _ "Inelii"
        canrecruit=yes
        recruit=""
        #{GOLD 120 140 150}
        #{INCOME 30 35 40}
        facing=sw
        color=green
        hidden=yes

        [ai]
            passive_leader=yes
        [/ai]
    [/side]
    [side]
        side=3
        controller=ai
        team_name=monster
        user_team_name=_"Local Monsters"
        no_leader=yes
        color=white
        [ai]
            aggression=0.8
            [aspect]
                id=attacks
                [facet]
                    invalidate_on_gamestate_change=yes
                    [filter_own]
                        race=monster
                    [/filter_own]
                    [filter_enemy]
                        side=1
                    [/filter_enemy]
                [/facet]
            [/aspect]
        [/ai]

        {GENERIC_UNIT 3 "Giant Spider" 3 5}
        {UNIT 3 "Giant Spider" 9 22 id=Spider}
        {GENERIC_UNIT 3 "Giant Scorpion" 5 7}
        {GENERIC_UNIT 3 "Giant Scorpion" 5 21} {GUARDIAN}
        {GENERIC_UNIT 3 "Giant Scorpion" 6 2}
        {GENERIC_UNIT 3 "Giant Scorpion" 12 5}
        {GENERIC_UNIT 3 "Cuttle Fish" 46 1}
        {GENERIC_UNIT 3 "Sea Serpent" 11 13} {GUARDIAN}
        {GENERIC_UNIT 3 "Giant Rat" 3 21}
        {GENERIC_UNIT 3 "Giant Rat" 6 17}
        {GENERIC_UNIT 3 "Giant Rat" 3 13}
        {GENERIC_UNIT 3 "Giant Rat" 16 8}
        {GENERIC_UNIT 3 "Giant Rat" 18 26}
        {GENERIC_UNIT 3 "Giant Rat" 26 35}
        {GENERIC_UNIT 3 "Giant Rat" 34 14}
        {GENERIC_UNIT 3 "Giant Rat" 35 29}
        {GENERIC_UNIT 3 "Giant Rat" 39 21}
    [/side]
    [side]
        side=4
        controller=ai
        team_name=human
        user_team_name=_"Stray Humans"
        no_leader=yes
        recruit=Rogue,Outlaw
        #{GOLD 180 200 210}
        #{INCOME 40 50 60}
        color=purple
        facing=se
        hidden=yes
        [ai]
            passive_leader=yes
            recruitment_pattern=fighter,mixed fighter,fighter,mixed fighter
        [/ai]
    [/side]

    [event]
        name=start
        [delay]
            time=500
        [/delay]
        {SCROLL_TO 48 7}
        [lift_fog]
            [filter_side]
                side=1
            [/filter_side]
            x=48-39,38,37,36,35,34,33,32,31,30-28,27,26
            y=7,6,7,6,7,6,7,6,7,6,5,4
            radius=2
            multiturn=no
        [/lift_fog]

        [move_unit_fake]
            side=1
            type=Transport Galleon
            x=48-39,38,37,36,35,34,33,32,31,30-28,27
            y=7,6,7,6,7,6,7,6,7,6,5
        [/move_unit_fake]
        [item]
            image="units/transport/transport-galleon.png~RC(magenta>red)~FL(horizontal)"
            x,y=27,5
        [/item]
        {SCROLL_TO 27 5}

        [unstore_unit]
            variable=skaphee_stored3
        [/unstore_unit]
        {CLEAR_VARIABLE skaphee_stored3}

        {MODIFY_UNIT id=Skaphee facing sw}

        [terrain]
            terrain=Csz^Ksy
            x,y=26,4
        [/terrain]
        [terrain]
            terrain=Csz
            x=25,26,26,27
            y=4-5,3,5,4
        [/terrain]
        [redraw][/redraw]

        [recall]
            id=Waklex
        [/recall]
        [recall]
            id=Irixzik
        [/recall]
        [recall]
            id=Chamlis
            x,y=26,3
        [/recall]
        [if]
            [not]
                [have_unit]
                    id=Chamlis
                    x,y=26,3
                [/have_unit]
            [/not]
            [then]
                [recall]
                    role=dwarf_steersman2
                    x,y=26,3
                [/recall]
            [/then]
        [/if]
        [recall]
            id=Naxaffz
            x,y=26,5
        [/recall]
        [if]
            [not]
                [have_unit]
                    id=Naxaffz
                    x,y=26,5
                [/have_unit]
            [/not]
            [then]
                [recall]
                    role=dwarf_steersman1
                    x,y=26,5
                [/recall]
            [/then]
        [/if]
        [recall]
            race=lizard
            x,y=27,4
        [/recall]
        {SPEAK Skaphee ( _ "Whew... It was an exhausting journey, wasn't it?")}
        {SPEAK Waklex ( _ "Ah-ha! But we finally got back to Bilheld.")}
        {SPEAK Irixzik ( _ "It is very foggy here.")}
        {SPEAK Skaphee ( _ "Yes, almost like in the Shimmering Isle.")}
        {SPEAK_NARRATOR ( _ "<i>Saurian Fighters</i> are available to recruit; however, carapaced units cannot be recruited or recalled on this level.")}
    [/event]

    [event]
        name=prestart
        [objectives]
            side=1
            [objective]
                description= _ "Defeat the enemy leaders"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Skaphee"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Waklex"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Irixzik"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=60
            [/gold_carryover]
        [/objectives]
        [store_unit]
            [filter]
                id=Skaphee
            [/filter]
            variable=skaphee_stored3
            kill=yes
        [/store_unit]
        [store_unit]
            [filter]
                race=carapace
                side=1
            [/filter]
            variable=carapaces_stored
            kill=yes
        [/store_unit]
        [disallow_recruit]
            side=1
            type=Carapacian Forager,Carapacian Hunter,Carapacian Protector,Deep Saurian Augur,Deep Saurian Fighter,Deep Saurian Blacksmith,Deep Saurian Rider
        [/disallow_recruit]
        [allow_recruit]
            side=1
            type=Saurian Fighter
        [/allow_recruit]
        [kill]
            id=Peldullas
        [/kill]
        {PLACE_IMAGE "scenery/rock2.png" 11,18,24 9,25,40}
        {PLACE_IMAGE "scenery/rock3.png" 22,37 1,22}
        {PLACE_IMAGE "scenery/rock4.png" 3,27 3,11}
        {PLACE_IMAGE "items/gold.png" 9,10,12 33,34,40}
        {PLACE_IMAGE "units/transport/transport-galleon.png~RC(magenta>purple)" 8 39}

        [capture_village]
            side=2
            x=26,32,32
            y=18,16,21
        [/capture_village]
        {ATO_MAI_RG 3 Spider 9 22}
        [micro_ai]
            side=3
            ai_type=wolves
            action=add
            [filter]
                type=Giant Rat
            [/filter]
            [filter_second]
                side=1
            [/filter_second]
        [/micro_ai]
    [/event]
    [event]
        name=moveto
        first_time_only=no
        [filter]
            side=1,2,3,4
            [filter_location]
                terrain=Uu^Ecf
            [/filter_location]
        [/filter]
        [set_variable]
            name=burnt_unit.id
            value=$unit.id
        [/set_variable]
        [set_variable]
            name=unit.hitpoints
            add=-2
        [/set_variable]
        [unstore_unit]
            variable=unit
            text=_"2"
            {COLOR_HARM}
        [/unstore_unit]
        [if]
            [variable]
                name=unit.hitpoints
                less_than=3
            [/variable]
            [not]
                [variable]
                    name=burnt_unit.id
                    equals=Skapahee
                [/variable]
                [or]
                    [variable]
                        name=burnt_unit.id
                        equals=Waklex
                    [/variable]
                [/or]
                [or]
                    [variable]
                        name=burnt_unit.id
                        equals=Irixzik
                    [/variable]
                [/or]
            [/not]
            [then]
                [kill]
                    id=$unit.id
                    animate=yes
                [/kill]
                {CLEAR_VARIABLE burnt_unit.id}
            [/then]
            [else]
                {CLEAR_VARIABLE burnt_unit.id}
            [/else]
        [/if]
    [/event]

    [event]
        name=sighted,moveto
        [filter]
            id=Inelii
            [filter_vision]
                side=1
            [/filter_vision]
        [/filter]
        [remove_shroud]
            side=1
            x=29,30,31
            y=18-19,17-19,28-19
        [/remove_shroud]
        [lift_fog]
            [filter_side]
                side=1
            [/filter_side]
            x=29,30,31
            y=18-19,17-19,28-19
            radius=1
            multiturn=no
        [/lift_fog]
        [redraw]
            side=1
        [/redraw]
        {SPEAK second_unit ( _ "Uh! Nagas!")}
        {SCROLL_TO 28 18}
        {ATO_DELAY 500}
        {SCROLL_TO $second_unit.x $second_unit.y}
        {SPEAK unit ( _ "Lizards...? Hmmm... You must be friends of the Drakes... So you must be our enemies!")}

        {GENERIC_UNIT 2 "Naga Warrior" 29 18} {FACING sw}
        {GENERIC_UNIT 2 "Naga Warrior" 29 19} {FACING sw}
        {GENERIC_UNIT 2 "Naga Warrior" 30 17} {FACING sw}
        {GENERIC_UNIT 2 "Naga Warrior" 30 19} {FACING sw}
        {GENERIC_UNIT 2 "Naga Warrior" 31 19} {FACING sw}

        [modify_side]
            side=2
            recruit=Naga Warrior
            {GOLD 180 190 200}
            {INCOME 40 45 50}
            hidden=no
        [/modify_side]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x=1-3,4-10,11-12,13-14,15-16,17-18,19-21,22
            y=28-40,27-40,28-40,29-40,30-40,31-40,32-40,33-36
        [/filter]

        {NAMED_UNIT 4 "Silver Mage" 5 37 Yumeal (_"Yumeal") (
            profile="portraits/yumeal.png"
            unrenamable=yes
            gender=female
            canrecruit=yes
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
            facing=se
        )}

        {UNIT 4 Outlaw 4 36 (
            id=Guard_1
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
        )}
        {UNIT 4 "Assassin" 4 37 (
            id=Guard_2
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
        )}
        {UNIT 4 Rogue 5 36 (
            id=Guard_3
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
        )}
        {UNIT 4 "Assassin" 5 38 (
            id=Guard_4
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
        )}
        {UNIT 4 Outlaw 6 36 (
            id=Guard_5
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
        )}
        {UNIT 4 "Assassin" 6 37 (
            id=Guard_6
            [modifications]
                {TRAIT_LOYAL}
                {TRAIT_RESILIENT}
            [/modifications]
        )}

        [micro_ai]
            side=4
            ai_type=zone_guardian
            action=add
            id=Guard_2
            [filter_location]
                x=1,2,2,3
                y=35-36,34,36,35-36
            [/filter_location]
            station_x,station_y=2,35
        [/micro_ai]
        [micro_ai]
            side=4
            ai_type=zone_guardian
            action=add
            id=Guard_6
            [filter_location]
                x=7,8,8,9
                y=35-36,34,36,35-36
            [/filter_location]
            station_x,station_y=8,35
        [/micro_ai]

        {ATO_MAI_HGO 4 Guard_1}
        {ATO_MAI_HGO 4 Guard_3}
        {ATO_MAI_HGO 4 Guard_5}

        {ATO_MAI_RG 4 Guard_4 2 38}

        [modify_side]
            side=4
            {GOLD 220 230 240}
            {INCOME 50 60 70}
            hidden=no
        [/modify_side]
    [/event]
    [event]
        name=sighted,moveto
        [filter]
            side=4
            [filter_vision]
                side=1
            [/filter_vision]
        [/filter]
        {SCROLL_TO $unit.x $unit.y}
        {ATO_DELAY 500}
        {SPEAK second_unit ( _ "Uh! Humans! There are humans in this island.")}
        [if]
            [variable]
                name=second_unit.id
                equals=Skaphee
            [/variable]
            [then]
				{SPEAK Waklex( _ "Uh-oh... It is as we feared.")}
            [/then]
            [else]
				{SPEAK Waklex( _ "Uh-oh... Skaphee is right.")}
            [/else]
        [/if]
    [/event]
    [event]
        name=sighted,moveto
        [filter]
            id=Yumeal
            [filter_vision]
                side=1
            [/filter_vision]
        [/filter]
        [remove_shroud]
            side=1
            x=4,5,6
            y=36-37,36-38,36-37
        [/remove_shroud]
        [lift_fog]
            [filter_side]
                side=1
            [/filter_side]
            x=4,5,6
            y=36-37,36-38,36-37
            radius=1
            multiturn=no
        [/lift_fog]
        [redraw]
            side=1
        [/redraw]
        {SCROLL_TO 5 37}
        {ATO_DELAY 500}
        {SPEAK Skaphee ( _ "That is the mage we saw beside the river!")}
        {MODIFY_UNIT id=Yumeal facing se}
        {SPEAK Yumeal ( _ "Hm...? Lizards...? It seems I met you before. What happened to Blonga?")}
        {SPEAK Waklex ( _ "That evil mage is dead!")}
        {SPEAK Yumeal ( _ "Oh, she is...? It doesn't matter. She did not have much gold anyway. I want more gold...")}
        {SPEAK Skaphee ( _ "Why do you need gold so much? Gold can buy everyday items, but the most important things in this world cannot be had for any price. I keep telling it to my attendants.")}
        {SPEAK Yumeal ( _ "Shut your noisy mouth, lizard! I will silence you for good. You will never defeat us.")}
        [objectives]
            side=1
            [objective]
                description= _ "Try to attack the mage"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Skaphee"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Waklex"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Irixzik"
                condition=lose
            [/objective]
            [objective]
                description= _ "Turns run out"
                condition=lose
            [/objective]
            [gold_carryover]
                bonus=yes
                carryover_percentage=60
            [/gold_carryover]
        [/objectives]
    [/event]
    [event]
        name=moveto
        [filter]
            side=1
            x=4,5,6
            y=36-37,36-38,36-37
        [/filter]
        {SPEAK Yumeal ( _ "He,he,he, I told you you were unable to defeat us. We have already researched this island well. See you later...")}
        [store_unit]
            [filter]
                id=Yumeal
            [/filter]
            variable=yumeal_stored
            kill=yes
        [/store_unit]
        {ATO_TELEPORT_ANIM 5 37}

        {SPEAK unit ( _ "Uh! She has teleported!")}
        [if]
            [not]
                [have_unit]
                    side=2
                    canrecruit=yes
                [/have_unit]
            [/not]
            [then]
                [endlevel]
                    result=victory
                    bonus=yes
                    {NEW_GOLD_CARRYOVER 60}
                [/endlevel]
            [/then]
            [else]
                [set_variable]
                    name=yumeal_teleported
                    value=yes
                [/set_variable]
                [objectives]
                    side=1
                    [objective]
                        description= _ "Defeat the enemy leader"
                        condition=win
                    [/objective]
                    [objective]
                        description= _ "Death of Skaphee"
                        condition=lose
                    [/objective]
                    [objective]
                        description= _ "Death of Waklex"
                        condition=lose
                    [/objective]
                    [objective]
                        description= _ "Death of Irixzik"
                        condition=lose
                    [/objective]
                    [objective]
                        description= _ "Turns run out"
                        condition=lose
                    [/objective]
                    [gold_carryover]
                        bonus=yes
                        carryover_percentage=60
                    [/gold_carryover]
                [/objectives]
            [/else]
        [/if]
    [/event]
    [event]
        name=last breath
        [filter]
            id=Inelii
        [/filter]
        [if]
            [variable]
                name=yumeal_teleported
                not_equals=yes
            [/variable]
            [then]
				{SPEAK unit( _ "Aaargh...")}
                [kill]
                    id=Inelii
                    animate=yes
                [/kill]
                {GENERIC_UNIT 3 "Sea Serpent" 47 40}
            [/then]
            [else]
				{SPEAK unit( _ "Aaargh... That is why I did not want to assist humans...")}
                [kill]
                    id=Psenis
                    animate=yes
                [/kill]
                {CLEAR_VARIABLE yumeal_teleported}
                [endlevel]
                    result=victory
                    bonus=yes
                    {NEW_GOLD_CARRYOVER 60}
                [/endlevel]
            [/else]
        [/if]
    [/event]
    [event]
        name=victory
        {SPEAK Skaphee ( _ "Uh-oh... I think we had better hurry... I hope the Drakes are fine.")}
    [/event]
    {ATO_HERO_DEATH}
    {YOUNG_PRERECRUIT "Saurian Fighter"}
	{YOUNG_PRERECRUIT "Saurian Skirmisher"}
	{YOUNG_PRERECRUIT "Saurian Augur"}
	{YOUNG_PRERECRUIT "Saurian Blacksmith"}
[/scenario]
